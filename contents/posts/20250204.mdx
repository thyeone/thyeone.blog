---
title: 전역 상태에 대한 고찰
description: 내가 전역 상태를 관리하는 방법
date: 2025-02-04
thumbnail: /posts/20250202.webp
---

<br />
<Callout type="info">
  지금부터 언급되는 전역 상태는 클라이언트 상태만을 의미합니다.
</Callout>

한동안 전역 상태에 대해 쭉 관심이 없다가 다시 관심이 생겼습니다.
관심이 없었던 이유는, 많은 전역 상태 라이브러리와 방법들을 사용해봤지만 결국 `Context API`로 정착한지 꽤 됐기 때문입니다.
최근 들어, Toss의 <MDXLink href="https://github.com/toss/frontend-fundamentals/discussions/5">Frontend Fundamentals</MDXLink> 라는 문서를 보다가 해당 <MDXLink href="https://github.com/toss/frontend-fundamentals/discussions/5">전역 상태를 사용하는 기준이 있으신가요?</MDXLink>라는 토론을 보게 되었습니다.

질문 자체의 요점은 단순히 어느 depth에서 전역 상태를 사용하면 좋을지에 대한 질문이였으나, 그에 대한 코멘트들을 정말 인상적이게 봤습니다.

코멘트를 읽으면서, 제가 전역 상태를 어떤 기준으로 선택하는지 한 번 정리해보는 계기가 되었던 것 같습니다. 그에 대한 생각을 정리해보려고 해요.

## 전역 상태에 대한 고찰

### 전역 상태를 사용하는 이유와 문제점

보통 React에서 전역 상태를 사용하는 이유는 다음과 같습니다.

1. 라우팅이 전환됐을 때도 상태값을 사용해야 하는 경우, 어플리케이션 전체에 의존
2. 한 페이지 내 여러 컴포넌트에서 상태값을 공유해야 해서 **Props Drilling**을 피하고 싶은 경우
3. 비즈니스 로직을 한 곳에 응축하고 싶은 경우

**1번** 케이스의 경우 개발하면서 마주치는 빈도수가 드문 편이라고 생각합니다. 복잡한 어플리케이션일 경우 전역 상태가 가져다 주는 이점이 분명히 있을 것입니다. 라우팅이 전환되었을 때도 상태값에 의존해야 한다면 Funnel 패턴으로 해결할 수 있었어요. 하지만, **1번** 케이스일 때 전역 상태를 사용했을 때 특정 시점에서 초기화된 값이 필요한데 초기화가 되지 않아 엉뚱한 값이 보여지는 문제가 발생한 경험이 생각납니다. 위에 링크한 토론에서도 그 케이스를 언급하고 있구요.

**2번** 케이스의 경우 **지역적**으로 사용됨에도 불구하고 스토어를 생성해서 대규모 프로젝트에서 **스토어**가 매우 **방대**해질 수 있습니다. 이런 경우, 어떤 **스코프**에서 전역 상태가 사용되는지 파악이 어렵고 개발자는 코드 흐름을 파악하기 어려워 디버깅 시간이 증가합니다. 또한, **지역적**으로 사용해야하는 상태인데 전역으로 관리되어 메모리 낭비도 있다고 생각합니다.

문제점을 정리해보자면,

1. 상태를 초기화하기가 어려워 엉뚱한 값이 보여질 수 있다.
2. 전역 상태가 어떤 스코프에서 사용되는지 파악이 어렵다.
3. 대규모 프로젝트에서 스토어가 방대해질 수 있다. 따라서, 코드 흐름 파악이 어려워 디버깅 난이도가 증가한다.
4. 메모리 낭비가 발생할 수 있다.

### 전역 상태를 사용하는 방법

저는 위의 문제를 해결하기 위해 `Context API`를 사용해왔습니다. **Provider**로 감싸면 해당 컴포넌트 트리 내에서 전역 상태를 사용할 수 있고 1~4번 문제를 모두 해결할 수 있습니다.

```tsx
const ArticleContext = createContext(null);

function ArticleProvider({ children }: PropsWithChildren) {
  const [count, setCount] = useState(0);

  return (
    <ArticleContext.Provider value={value}>{children}</ArticleContext.Provider>
  );
}

function App() {
  return (
    <ArticleProvider>
      <Article />
    </ArticleProvider>
  );
}
```

그 중에서도, 가장 인상깊게 봤던 답변은 <MDXLink href="https://github.com/toss/frontend-fundamentals/discussions/5#discussioncomment-11831458">해당 링크</MDXLink>였습니다.
